<h1>Schemas</h1>

<h2>Add new schema</h2>
<form method="post" enctype="multipart/form-data" name="add">
  <div class="field">
    <label>Package</label><br />
    <select name="package_id" id="package_id">
        #for $p in $packages
        #if $resourcetypes[$p]
        <option value="$p" onclick="changePackage('$p');">$p</option>
        #end if
        #end for
    </select>
  </div>
  <div class="field">
    <label>Resource type</label><br />
    <select name="resourcetype_id" id="resourcetype_id"></select>
  </div>
  <div class="field">
    <label>Label</label><br />
    <input type="text" size="20" name="type" />
  </div>
  <div class="field">
    <label>XSD File</label><br />
    <input name="file" type="file" size="50" maxlength="100000" 
           accept="application/xsd+xml" />
  </div>

  <input type="submit" value="Add" />
</form>

<br />
<br />

<h2>List of all schemas</h2>
<form method="post" name="list">
  <div class="field">
    #for $schema in $schemas
    <input type="checkbox" name="schema[]" value="$schema.resource_id" /> 
    $schema.package_id
    $schema.resourcetype_id
    $schema.type
    <br />
    #end for
  </div>

  <input type="submit" name="delete" value="Delete" />
</form>

<script type="text/javascript">
    var resourcetypes = new Array();
    #for $p in $packages
    resourcetypes['$p'] = $resourcetypes[$p];
    #end for

    function changePackage(package_id)
    {
      var selectbox = document.getElementById('resourcetype_id');
      selectbox.options.length = 0;
      for (var i=0;i<resourcetypes[package_id].length;i++)
      {
        var link = resourcetypes[package_id][i];
        var addme = new Option(link, link);
        selectbox.options[i] = addme;
      }
    }
    changePackage('$packages[0]');
</script>