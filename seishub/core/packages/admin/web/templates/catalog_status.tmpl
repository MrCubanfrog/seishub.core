#def CSS
<link rel="stylesheet" type="text/css" href="/yui2/build/fonts/fonts-min.css" />
<link rel="stylesheet" type="text/css" href="/yui2/build/datatable/assets/skins/sam/datatable.css" />
#end def
#def JAVASCRIPT
<script type="text/javascript" src="/yui2/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="/yui2/build/connection/connection-min.js"></script>
<script type="text/javascript" src="/yui2/build/element/element-min.js"></script>
<script type="text/javascript" src="/yui2/build/datasource/datasource-min.js"></script>
<script type="text/javascript" src="/yui2/build/datatable/datatable-min.js"></script>
<script type="text/javascript" src="/yui2/build/event-delegate/event-delegate-min.js"></script>
#end def


<h1>Status</h1>

<h2>Tables</h2>
<div id="tables"></div>

<br />

<h2>Views</h2>
<div id="views"></div>

<br />

<h2>Integrity Checks</h2>
<pre id="dbcheck"></pre>


<script type="text/javascript">
/* <![CDATA[ */

YAHOO.util.Event.addListener(window, "load", function() {
    YAHOO.example.XHR_Text = function() {

        var tablesColumnDefs = [
            {key:"Name", sortable:true},
            {key:"Entries"},
            {key:"Size"},
        ];

        var tablesSource = new YAHOO.util.DataSource("/manage/catalog/status/tables");
        tablesSource.responseType = YAHOO.util.DataSource.TYPE_TEXT;
        tablesSource.responseSchema = {
            recordDelim: "\n",
            fieldDelim: "|",
            fields: ["Name","Entries","Size"]
        };

        var tablesTable = new YAHOO.widget.DataTable("tables",
            tablesColumnDefs, tablesSource);

        var viewsColumnDefs = [
            {key:"Name", sortable:true},
            {key:"Entries"},
        ];

        var viewsSource = new YAHOO.util.DataSource("/manage/catalog/status/views");
        viewsSource.responseType = YAHOO.util.DataSource.TYPE_TEXT;
        viewsSource.responseSchema = {
            recordDelim: "\n",
            fieldDelim: "|",
            fields: ["Name","Entries"]
        };

        var viewsTable = new YAHOO.widget.DataTable("views",
            viewsColumnDefs, viewsSource);
                
        return {
            oDS: tablesSource,
            oDT: tablesTable,
            oDS2: viewsSource,
            oDT2: viewsTable
        };
    }();

    function successHandler(o){
        var root = o.responseText;
        var pre = document.getElementById('dbcheck');
        pre.innerHTML = root;
    }

    var request = YAHOO.util.Connect.asyncRequest('GET',
        "/manage/catalog/status/dbcheck", { success:successHandler });
});

/* ]]> */
</script>
